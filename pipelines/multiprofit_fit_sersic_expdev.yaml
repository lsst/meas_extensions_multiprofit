description: |
  Extended MultiProFit pipeline with additional models
imports:
  - location: $MEAS_EXTENSIONS_MULTIPROFIT_DIR/pipelines/_ingredients/LSSTCam/DRP.yaml
parameters:
  expdev_init_table: deepCoadd_Sersic_multiprofit
tasks:
  fitDeblendedObjectsExpDeV:
    class: lsst.meas.extensions.multiprofit.pipetasks_fit.MultiProFitCoaddExpDeVFitTask
    config:
      python: |
        from lsst.meas.extensions.multiprofit.pipetasks_fit import InputConfig, MakeCachedChainedInitializerAction
        config.finalize(
          add_point_source=parameters.add_point_source,
          fix_centroid=parameters.fix_centroid,
          use_shapelet_psf=parameters.use_shapelet_psf,
        )
        if parameters.expdev_init_table:
          config.inputs_init = {
            parameters.expdev_init_table: InputConfig(
              doc=f"{parameters.expdev_init_table} fit parameters",
              is_multiband=True,
            )
          }
contracts:
  - fitDeepCoaddPsfGaussians.use_cell_coadds == fitDeblendedObjectsExpDeV.use_cell_coadds
